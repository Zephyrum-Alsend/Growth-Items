scn aaZefirosGetEnchChoice

;Main script
;-----------------------------------------------------------------------------
;aaZefirosManager
;-----------------------------------------------------------------------------

;Used scripts
;-----------------------------------------------------------------------------
;-----------------------------------------------------------------------------

;Related scripts
;-----------------------------------------------------------------------------
;aaZefirosGetEnchantData
;-----------------------------------------------------------------------------

;Used globals
;-----------------------------------------------------------------------------
;-----------------------------------------------------------------------------

;Related globals
;-----------------------------------------------------------------------------
;-----------------------------------------------------------------------------

;Description
;-----------------------------------------------------------------------------
;Menu code for selecting an enchantment.
;Prompts the player what effect they want, with multiple pages for the Fortify
;effects.  Does allow going back, but not cancelling.  Uses the passed Button 
;and Page Shorts to determine what to display, with Type restricting which 
;effects are available.
;Page contains -1 when an effect has been chosen, and Button then contains the
;index the effect's data can be found in GetEnchantData.
;-----------------------------------------------------------------------------

;Parameters
;-----------------------------------------------------------------------------
string_var Name
short Type
short Button
short Page

array_var Next ;Return value
string_var Msg
;-----------------------------------------------------------------------------

;-----------------------------------------------------------------------------
begin Function { Name, Type, Button, Page }
;-----------------------------------------------------------------------------

	if ( Button < 0 )

		Let Button := GetButtonPressed

	endif


	;-----------------------------------------------------------------------------
	;Page 0
	;-----------------------------------------------------------------------------
	if ( Page == 0 )

		Let Msg := Name + " seeks an enchantment:"

		;Armor options
		if ( Type == 0 )

			MessageBox $Msg "Fortify..." "Restore..." "Shield" "Feather"

		;Shield options
		elseif ( Type == 1 )

			MessageBox $Msg "Fortify..." "Restore..." "Shield" "Feather" "Reflect Damage" "Reflect Spell" "Spell Absorption"
			
		endif

		Let Page := 1


	;-----------------------------------------------------------------------------
	;Page 1 - Option Select
	;-----------------------------------------------------------------------------
	elseif ( Page == 1 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Fortify Redirect
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Msg := Name + " seeks a Fortify enchantment:"

			MessageBox $Msg "Back" "Attribute" "Resource" "Skill"
			Let Page := 2
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Restore Select
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Msg := Name + " seeks a Restore enchantment:"

			MessageBox $Msg "Back" "Fatigue" "Health" "Magicka"
			Let Page := 3
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Shield
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 35

		;-----------------------------------------------------------------------------
		;Feather
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 36

		;-----------------------------------------------------------------------------
		;Reflect Damage
		;-----------------------------------------------------------------------------
		elseif ( Button == 4 )

			Let Page := -1
			Let Button := 37

		;-----------------------------------------------------------------------------
		;Reflect Spell
		;-----------------------------------------------------------------------------
		elseif ( Button == 5 )

			Let Page := -1
			Let Button := 38

		;-----------------------------------------------------------------------------
		;Spell Absorption
		;-----------------------------------------------------------------------------
		elseif ( Button == 6 )

			Let Page := -1
			Let Button := 39

		endif


	;-----------------------------------------------------------------------------
	;Page 2 - Fortify
	;-----------------------------------------------------------------------------
	elseif ( Page == 2 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 0
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Attribute
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Msg := Name + " seeks a Fortify Attribute enchantment:"

			MessageBox $Msg "Back" "Strength" "Intelligence" "Willpower" "Agility" "Speed" "Endurance" "Personality" "Luck"
			Let Page := 4
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Resource
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Msg := Name + " seeks a Fortify Resource enchantment:"

			MessageBox $Msg "Back" "Fatigue" "Health" "Magicka"
			Let Page := 5
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Skill
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Msg := Name + " seeks a Fortify Skill enchantment:"

			MessageBox $Msg "Back" "Armorer" "Athletics" "Blade" "Block" "Blunt" "Hand To Hand" "Heavy Armor" "Alchemy" "Next"
			Let Page := 6
			Let Button := -1

		endif


	;-----------------------------------------------------------------------------
	;Page 3 - Restore
	;-----------------------------------------------------------------------------
	elseif ( Page == 3 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 0
			Let Button := -1

		;-----------------------------------------------------------------------------
		;Restore Fatigue
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 32

		;-----------------------------------------------------------------------------
		;Restore Health
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 33

		;-----------------------------------------------------------------------------
		;Restore Magicka
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 34

		endif


	;-----------------------------------------------------------------------------
	;Page 4 - Fortify Attribute
	;-----------------------------------------------------------------------------
	elseif ( Page == 4 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 1
			Let Button := 0
		
		;-----------------------------------------------------------------------------
		;Fortify Strength
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 0
		
		;-----------------------------------------------------------------------------
		;Fortify Intelligence
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 1
		
		;-----------------------------------------------------------------------------
		;Fortify Willpower
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 2
		
		;-----------------------------------------------------------------------------
		;Fortify Agility
		;-----------------------------------------------------------------------------
		elseif ( Button == 4 )

			Let Page := -1
			Let Button := 3
		
		;-----------------------------------------------------------------------------
		;Fortify Speed
		;-----------------------------------------------------------------------------
		elseif ( Button == 5 )

			Let Page := -1
			Let Button := 4
		
		;-----------------------------------------------------------------------------
		;Fortify Endurance
		;-----------------------------------------------------------------------------
		elseif ( Button == 6 )

			Let Page := -1
			Let Button := 5
		
		;-----------------------------------------------------------------------------
		;Fortify Personality
		;-----------------------------------------------------------------------------
		elseif ( Button == 7 )

			Let Page := -1
			Let Button := 6
		
		;-----------------------------------------------------------------------------
		;Fortify Luck
		;-----------------------------------------------------------------------------
		elseif ( Button == 8 )

			Let Page := -1
			Let Button := 7

		endif


	;-----------------------------------------------------------------------------
	;Page 5 - Fortify Resource
	;-----------------------------------------------------------------------------
	elseif ( Page == 5 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 1
			Let Button := 0
		
		;-----------------------------------------------------------------------------
		;Fortify Fatigue
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 29

		;-----------------------------------------------------------------------------
		;Fortify Health
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 30
		
		;-----------------------------------------------------------------------------
		;Fortify Magicka
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 31

		endif

		
	;-----------------------------------------------------------------------------
	;Page 6 - Fortify Skill I
	;-----------------------------------------------------------------------------
	elseif ( Page == 6 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 1
			Let Button := 0
		
		;-----------------------------------------------------------------------------
		;Fortify Armorer
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 8
		
		;-----------------------------------------------------------------------------
		;Fortify Athletics
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 9
		
		;-----------------------------------------------------------------------------
		;Fortify Blade
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 10
		
		;-----------------------------------------------------------------------------
		;Fortify Block
		;-----------------------------------------------------------------------------
		elseif ( Button == 4 )

			Let Page := -1
			Let Button := 11
		
		;-----------------------------------------------------------------------------
		;Fortify Blunt
		;-----------------------------------------------------------------------------
		elseif ( Button == 5 )

			Let Page := -1
			Let Button := 12
		
		;-----------------------------------------------------------------------------
		;Fortify Hand To Hand
		;-----------------------------------------------------------------------------
		elseif ( Button == 6 )

			Let Page := -1
			Let Button := 13
		
		;-----------------------------------------------------------------------------
		;Fortify Heavy Armor
		;-----------------------------------------------------------------------------
		elseif ( Button == 7 )

			Let Page := -1
			Let Button := 14
		
		;-----------------------------------------------------------------------------
		;Fortify Alchemy
		;-----------------------------------------------------------------------------
		elseif ( Button == 8 )

			Let Page := -1
			Let Button := 15

		;-----------------------------------------------------------------------------
		;Next
		;-----------------------------------------------------------------------------
		elseif ( Button == 9 )

			Let Msg := Name + " seeks a Fortify Skill enchantment:"

			MessageBox $Msg "Prev" "Alteration" "Conjuration" "Destruction" "Illusion" "Mysticism" "Restoration" "Acrobatics" "Light Armor" "Next"
			Let Page := 7
			Let Button := -1

		endif

		
	;-----------------------------------------------------------------------------
	;Page 7 - Fortify Skill II
	;-----------------------------------------------------------------------------
	elseif ( Page == 7 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 2
			Let Button := 3
		
		;-----------------------------------------------------------------------------
		;Fortify Alteration
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 16
		
		;-----------------------------------------------------------------------------
		;Fortify Conjuration
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 17
		
		;-----------------------------------------------------------------------------
		;Fortify Destruction
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 18
		
		;-----------------------------------------------------------------------------
		;Fortify Illusion
		;-----------------------------------------------------------------------------
		elseif ( Button == 4 )

			Let Page := -1
			Let Button := 19
		
		;-----------------------------------------------------------------------------
		;Fortify Mysticism
		;-----------------------------------------------------------------------------
		elseif ( Button == 5 )

			Let Page := -1
			Let Button := 20
		
		;-----------------------------------------------------------------------------
		;Fortify Restoration
		;-----------------------------------------------------------------------------
		elseif ( Button == 6 )

			Let Page := -1
			Let Button := 21
		
		;-----------------------------------------------------------------------------
		;Fortify Acrobatics
		;-----------------------------------------------------------------------------
		elseif ( Button == 7 )

			Let Page := -1
			Let Button := 22
		
		;-----------------------------------------------------------------------------
		;Fortify Light Armor
		;-----------------------------------------------------------------------------
		elseif ( Button == 8 )

			Let Page := -1
			Let Button := 23

		;-----------------------------------------------------------------------------
		;Next
		;-----------------------------------------------------------------------------
		elseif ( Button == 9 )

			Let Msg := Name + " seeks a Fortify Skill enchantment:"

			MessageBox $Msg "Prev" "Marksman" "Mercantile" "Security" "Sneak" "Speechcraft"
			Let Page := 8
			Let Button := -1

		endif

		
	;-----------------------------------------------------------------------------
	;Page 8 - Fortify Skill III
	;-----------------------------------------------------------------------------
	elseif ( Page == 8 && Button >= 0 )

		;-----------------------------------------------------------------------------
		;Back
		;-----------------------------------------------------------------------------
		if ( Button == 0 )

			Let Page := 6
			Let Button := 9
		
		;-----------------------------------------------------------------------------
		;Fortify Marksman
		;-----------------------------------------------------------------------------
		elseif ( Button == 1 )

			Let Page := -1
			Let Button := 24
		
		;-----------------------------------------------------------------------------
		;Fortify Mercantile
		;-----------------------------------------------------------------------------
		elseif ( Button == 2 )

			Let Page := -1
			Let Button := 25
		
		;-----------------------------------------------------------------------------
		;Fortify Security
		;-----------------------------------------------------------------------------
		elseif ( Button == 3 )

			Let Page := -1
			Let Button := 26
		
		;-----------------------------------------------------------------------------
		;Fortify Sneak
		;-----------------------------------------------------------------------------
		elseif ( Button == 4 )

			Let Page := -1
			Let Button := 27
		
		;-----------------------------------------------------------------------------
		;Fortify Speechcraft
		;-----------------------------------------------------------------------------
		elseif ( Button == 5 )

			Let Page := -1
			Let Button := 28
		
		endif


	;-----------------------------------------------------------------------------
	endif ;( Page > -1 )
	;-----------------------------------------------------------------------------


	sv_Destruct Msg
	Let Next := ar_Map 0::Button 1::Page
	SetFunctionValue Next
	Return
;-----------------------------------------------------------------------------
end ;Function { Name, Type, Button, Page }
;-----------------------------------------------------------------------------